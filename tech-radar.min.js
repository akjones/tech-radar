var tr=tr||{};tr.models={},tr.graphing={},tr.util={},tr.factory={},tr.graphing.Radar=function(t,n){function e(){return Math.round(t/2)}function r(t){return Math.PI*t/180}function a(n,a){var c=t*(1-(-Math.sin(r(a.startAngle))+1)/2),o=t*(1-(-Math.sin(r(a.startAngle-90))+1)/2),i=t*(1-(Math.cos(r(a.startAngle))+1)/2),u=t*(1-(Math.cos(r(a.startAngle-90))+1)/2);n.append("line").attr("x1",e()).attr("x2",e()).attr("y1",i).attr("y2",u).attr("stroke-width",14),n.append("line").attr("x1",c).attr("y1",e()).attr("x2",o).attr("y2",e()).attr("stroke-width",14)}function c(t,n){var r=g.sum(t.length),a=g.sum(n);return e()-e()*a/r}function o(t,n){var a=v.append("g").attr("class","quadrant-group quadrant-group-"+n.order);return t.forEach(function(o,i){var u=d3.svg.arc().innerRadius(i==t.length-1?0:c(t,i+1)).outerRadius(c(t,i)).startAngle(r(n.startAngle)).endAngle(r(n.startAngle-90));a.append("path").attr("d",u).attr("class","cycle-arc-"+o.order()).attr("transform","translate("+e()+", "+e()+")")}),a}function i(t,n,r){var a;a=Math.round(e()/n.length),n.forEach(function(a,o){"first"===r.order||"fourth"===r.order?t.append("text").attr("class","line-text").attr("y",e()+4).attr("x",e()+c(n,o)-b/2).attr("text-anchor","end").text(a.name()):t.append("text").attr("class","line-text").attr("y",e()+4).attr("x",e()-c(n,o)+b/2).text(a.name())})}function u(t,n,e,r){return r.append("path").attr("d","M412.201,311.406c0.021,0,0.042,0,0.063,0c0.067,0,0.135,0,0.201,0c4.052,0,6.106-0.051,8.168-0.102c2.053-0.051,4.115-0.102,8.176-0.102h0.103c6.976-0.183,10.227-5.306,6.306-11.53c-3.988-6.121-4.97-5.407-8.598-11.224c-1.631-3.008-3.872-4.577-6.179-4.577c-2.276,0-4.613,1.528-6.48,4.699c-3.578,6.077-3.26,6.014-7.306,11.723C402.598,306.067,405.426,311.406,412.201,311.406").attr("transform","scale("+b/34+") translate("+(-404+t*(34/b)-17)+", "+(-282+n*(34/b)-17)+")").attr("class",e)}function l(t,n,e,r){return(r||v).append("path").attr("d","M420.084,282.092c-1.073,0-2.16,0.103-3.243,0.313c-6.912,1.345-13.188,8.587-11.423,16.874c1.732,8.141,8.632,13.711,17.806,13.711c0.025,0,0.052,0,0.074-0.003c0.551-0.025,1.395-0.011,2.225-0.109c4.404-0.534,8.148-2.218,10.069-6.487c1.747-3.886,2.114-7.993,0.913-12.118C434.379,286.944,427.494,282.092,420.084,282.092").attr("transform","scale("+b/34+") translate("+(-404+t*(34/b)-17)+", "+(-282+n*(34/b)-17)+")").attr("class",e)}function d(t,n){var e=d3.select(".quadrant-table."+n);return e.append("h3").text(t),e.append("ul")}function s(t,n,a,c,o){var i=Math.sin(r(o))-Math.cos(r(o)),u=-Math.cos(r(o))-Math.sin(r(o)),l=r(t.integer({min:13,max:85})),d=t.floating({min:a+10,max:c-10}),s=e()+d*Math.cos(l)*i,p=e()+d*Math.sin(l)*u;return[s,p]}function p(t,n){return n.some(function(n){return Math.abs(n[0]-t[0])<b&&Math.abs(n[1]-t[1])<b})}function f(t,n,e){var r,a,o,i;a=e.quadrant,o=e.startAngle,i=e.order,r=a.blips(),n.forEach(function(e,f){var h,m,g;h=c(n,f),m=f==n.length-1?0:c(n,f+1);var g=r.filter(function(t){return t.cycle()==e}),v=e.name().split("").reduce(function(t,n){return t+n.charCodeAt(0)},0),y=a.name().split("").reduce(function(t,n){return t+n.charCodeAt(0)},0),b=new Chance(Math.PI*v*e.name().length*y*a.name().length),x=d(e.name(),i),A=[];g.forEach(function(n){for(var e=s(b,n,m,h,o);p(e,A);)e=s(b,n,m,h,o);A.push(e);var r=e[0],a=e[1],c=t.append("g").attr("class","blip-link");n.isNew()?u(r,a,i,c):l(r,a,i,c),c.append("text").attr("x",r).attr("y",a+4).attr("class","blip-text").attr("text-anchor","middle").text(n.number());var d=x.append("li");d.append("div").attr("class","blip-list-item").text(n.number()+". "+n.name()+". - "+n.topic());var f=d.append("div").attr("class","blip-item-description");n.description()&&f.append("p").text(n.description());var g=function(){d3.selectAll("g.blip-link").attr("opacity",.3),c.attr("opacity",1),d.selectAll(".blip-list-item").classed("highlight",!0),q.show(n.name(),c.node())},v=function(){d3.selectAll("g.blip-link").attr("opacity",1),d.selectAll(".blip-list-item").classed("highlight",!1),q.hide().style({left:0,top:0})};d.on("mouseover",g).on("mouseout",v),c.on("mouseover",g).on("mouseout",v);var y=function(){f.classed("expanded",!f.classed("expanded"))};d.on("click",y)})})}function h(n){function e(n){var e=n.order,c=n.startAngle;y.append("div").attr("class","quadrant-table "+e);var o=a.append("div").attr("class","button "+e).text(n.quadrant.name()).on("mouseover",function(){d3.select(".quadrant-group-"+e).style("opacity",1),d3.selectAll(".quadrant-group:not(.quadrant-group-"+e+")").style("opacity",.3)}).on("mouseout",function(){d3.selectAll(".quadrant-group:not(.quadrant-group-"+e+")").style("opacity",1)}).on("click",function(){d3.selectAll(".button").classed("selected",!1),o.classed("selected",!0),d3.selectAll(".quadrant-table").classed("selected",!1),d3.selectAll(".quadrant-table."+e).classed("selected",!0);var n=Math.sin(r(c))-Math.cos(r(c)),a=Math.cos(r(c))+Math.sin(r(c)),i=(-1-n)*t/2,u=(-1+a)*(t/2-7),l=(1-n)*t/2,d=(1+a)*t/2,s=(1+n)*(window.innerWidth-t)/2,p=(1-n)*(window.innerWidth-t)/2;v.style({left:p,right:s}),d3.select(".quadrant-group-"+e).transition().duration(1e3).attr("transform","translate("+i+","+u+")scale(2)"),d3.selectAll(".quadrant-group:not(.quadrant-group-"+e+")").transition().duration(1e3).attr("transform","translate("+l+","+d+")scale(0)")})}var a=y.append("header");_.each([0,3,2,1],function(t){e(n[t])})}var m,g,v,y,b=22,q=d3.tip().attr("class","d3-tip").html(function(t){return t});return q.direction(function(t){if(d3.select(".quadrant-table.selected").node()){var n=d3.select(".quadrant-table.selected");return n.classed("first")||n.classed("fourth")?"ne":"nw"}return"n"}),g=new tr.util.Fib,m={},m.svg=function(){return v},m.init=function(){return y=d3.select("body").append("div").attr("id","radar"),m},m.plot=function(){var e,r;e=n.cycles().reverse(),r=n.quadrants(),h(r),v=y.append("svg").call(q),v.attr("width",t).attr("height",t+14),_.each(r,function(t){var n=o(e,t);a(n,t),i(n,e,t),f(n,e,t)})},m},tr.models.Blip=function(t,n,e,r,a){var c,o;return c={},o=-1,c.name=function(){return t},c.topic=function(){return r||""},c.description=function(){return a||""},c.isNew=function(){return e},c.cycle=function(){return n},c.number=function(){return o},c.setNumber=function(t){o=t},c},tr.models.Cycle=function(t,n){var e={};return e.name=function(){return t},e.order=function(){return n},e},tr.models.Quadrant=function(t){var n,e;return n={},e=[],n.name=function(){return t},n.add=function(t){Array.isArray(t)?e=e.concat(t):e.push(t)},n.blips=function(){return e.slice(0)},n},tr.models.Radar=function(){function t(t){t.forEach(function(t){t.setNumber(++c)})}function n(){return _.pluck(a,"quadrant")}function e(){return n().reduce(function(t,n){return t.concat(n.blips())},[])}var r,a,c,o;return c=0,o=0,a=[{order:"first",startAngle:90},{order:"second",startAngle:0},{order:"third",startAngle:-90},{order:"fourth",startAngle:-180}],r={},r.addQuadrant=function(n){a[o].quadrant=n,t(n.blips()),o++},r.cycles=function(){return _.sortBy(_.map(_.uniq(e(),function(t){return t.cycle().name()}),function(t){return t.cycle()}),function(t){return t.order()})},r.quadrants=function(){return a},r},tr.util.Fib=function(){var t={};return t.sequence=function(t){for(var n=[0,1],e=2;t>e;e++)n[e]=n[e-2]+n[e-1];return n},t.sum=function(n){return 0===n?0:1===n?1:t.sequence(n+1).reduce(function(t,n){return t+n},0)},t},tr.factory.GoogleSheet=function(t){var n={};return n.build=function(){function n(t){d3.selectAll(".loading").remove();var n=_.pluck(_.uniq(t,"cycle"),"cycle"),e={};_.each(n,function(t,n){e[t]=new tr.models.Cycle(t,n)});var r={};_.each(t,function(t){r[t.quadrant]||(r[t.quadrant]=new tr.models.Quadrant(_.capitalize(t.quadrant))),r[t.quadrant].add(new tr.models.Blip(t.Name,e[t.cycle],"true"===t.isNew.toLowerCase(),t.topic,t.description))});var a=new tr.models.Radar;_.each(r,function(t){a.addQuadrant(t)});var c=window.innerHeight-133<600?600:window.innerHeight-133;new tr.graphing.Radar(c,a).init().plot()}Tabletop.init({key:t,callback:n,simpleSheet:!0})},n.init=function(){return d3.select("body").append("div").attr("class","loading").text("Loading your data..."),n},n},tr.factory.Radar=function(){var t={};return t.build=function(){var t;if(t=window.location.search.match(/\?sheetId=(.*)/))return tr.factory.GoogleSheet(t[1]).init().build();var n=d3.select("body").append("div").attr("class","input-sheet").append("form").attr("method","get");n.append("label").text("Please provide the id of your public google sheet:"),n.append("input").attr("type","text").attr("name","sheetId"),n.append("p").html("Don't know what to do here? Have a look at the <a href='https://github.com/thenano/tech-radar'>documentation</a>")},t};
//# sourceMappingURL=./tech-radar.min.js.map